var t=require("koffi"),n=require("winreg");function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r=/*#__PURE__*/e(t),u=/*#__PURE__*/e(n);function o(t){return t.getOption([].slice.call(arguments,1).join("."))}var i,c,s=function(t){try{var n=[].slice.call(arguments,1);if(!t.isConnected)throw new Error("Not connected ");var e=n[n.length-1];return n.pop(),Promise.resolve(t.setOption(n.join(".")+"="+e)).then(function(){return o.apply(void 0,[t].concat(n))})}catch(t){return Promise.reject(t)}};exports.Voicemeeter=/*#__PURE__*/function(){function t(){var t,n=this;this.isConnected=!1,this.isInitialised=!1,this.outputDevices=[],this.inputDevices=[],this.version="",this.type=void 0,this.eventPool=[],this.stringParameters=["Label","FadeTo","FadeBy","AppGain","AppMute","name","ip"],this.connect=function(){if(!n.isInitialised)throw new Error("Await the initialisation before connect");if(!n.isConnected){if(0===i.VBVMR_Login())return n.isConnected=!0,n.type=n.getVoicemeeterType(),n.version=n.getVoicemeeterVersion(),void setInterval(n.checkPropertyChange,10);throw n.isConnected=!1,new Error("Connection failed")}},this.disconnect=function(){if(!n.isConnected)throw new Error("Not connected ");try{if(0===i.VBVMR_Logout())return void(n.isConnected=!1);throw new Error("Disconnect failed")}catch(t){throw new Error("Disconnect failed")}},this.updateDeviceList=function(){if(!n.isConnected)throw new Error("Not connected ");n.outputDevices=[],n.inputDevices=[];for(var t=i.VBVMR_Output_GetDeviceNumber(),e=0;e<t;e++){var r=Buffer.alloc(256),u=Buffer.alloc(256),o=[0];i.VBVMR_Output_GetDeviceDescA(e,o,u,r),n.outputDevices.push({name:u.toString().replace(/\u0000+$/g,""),hardwareId:r.toString().replace(/\u0000+$/g,""),type:o[0]})}for(var c=i.VBVMR_Input_GetDeviceNumber(),s=0;s<c;s++){var a=Buffer.alloc(256),f=Buffer.alloc(256),p=[0];i.VBVMR_Input_GetDeviceDescA(s,p,f,a),n.inputDevices.push({name:f.toString().replace(/\u0000+$/g,""),hardwareId:a.toString().replace(/\u0000+$/g,""),type:p[0]})}},this.isParametersDirty=function(){return i.VBVMR_IsParametersDirty()},this.parameters=(t=this,{Command:{Shutdown:{set:function(n){return s(t,"Command","Shutdown",n)},get:function(){return o(t,"Command","Shutdown")}},Show:{set:function(n){return s(t,"Command","Show",n)},get:function(){return o(t,"Command","Show")}},Restart:{set:function(n){return s(t,"Command","Restart",n)},get:function(){return o(t,"Command","Restart")}},Eject:{set:function(n){return s(t,"Command","Eject",n)},get:function(){return o(t,"Command","Eject")}},Reset:{set:function(n){return s(t,"Command","Reset",n)},get:function(){return o(t,"Command","Reset")}},Save:{set:function(n){return s(t,"Command","Save",n)},get:function(){return o(t,"Command","Save")}},Load:{set:function(n){return s(t,"Command","Load",n)},get:function(){return o(t,"Command","Load")}},Lock:{set:function(n){return s(t,"Command","Lock",n)},get:function(){return o(t,"Command","Lock")}},Button:function(n){return{State:{set:function(e){return s(t,"Command","Button["+n+"]","State",e)},get:function(){return o(t,"Command","Button["+n+"]","State")}},StateOnly:{set:function(e){return s(t,"Command","Button["+n+"]","StateOnly",e)},get:function(){return o(t,"Command","Button["+n+"]","StateOnly")}},Trigger:{set:function(e){return s(t,"Command","Button["+n+"]","Trigger",e)},get:function(){return o(t,"Command","Button["+n+"]","Trigger")}},Color:{set:function(e){return s(t,"Command","Button["+n+"]","Color",e)},get:function(){return o(t,"Command","Button["+n+"]","Color")}}}},DialogShow:{VBANCHAT:{set:function(n){return s(t,"Command","DialogShow","VBANCHAT",n)},get:function(){return o(t,"Command","DialogShow","VBANCHAT")}}},SaveBUSEQ:function(n){return{set:function(e){return s(t,"Command","SaveBUSEQ["+n+"]",e)},get:function(){return o(t,"Command","SaveBUSEQ["+n+"]")}}},LoadBUSEQ:function(n){return{set:function(e){return s(t,"Command","LoadBUSEQ["+n+"]",e)},get:function(){return o(t,"Command","LoadBUSEQ["+n+"]")}}},SaveStripEQ:function(n){return{set:function(e){return s(t,"Command","SaveStripEQ["+n+"]",e)},get:function(){return o(t,"Command","SaveStripEQ["+n+"]")}}},LoadStripEQ:function(n){return{set:function(e){return s(t,"Command","LoadStripEQ["+n+"]",e)},get:function(){return o(t,"Command","LoadStripEQ["+n+"]")}}},Preset:function(n){return{Recall:{set:function(e){return s(t,"Command","Preset["+n+"]","Recall",e)},get:function(){return o(t,"Command","Preset["+n+"]","Recall")}}}}},Strip:function(n){return{Mono:{set:function(e){return s(t,"Strip["+n+"]","Mono",e)},get:function(){return o(t,"Strip["+n+"]","Mono")}},Mute:{set:function(e){return s(t,"Strip["+n+"]","Mute",e)},get:function(){return o(t,"Strip["+n+"]","Mute")}},Solo:{set:function(e){return s(t,"Strip["+n+"]","Solo",e)},get:function(){return o(t,"Strip["+n+"]","Solo")}},MC:{set:function(e){return s(t,"Strip["+n+"]","MC",e)},get:function(){return o(t,"Strip["+n+"]","MC")}},Gain:{set:function(e){return s(t,"Strip["+n+"]","Gain",e)},get:function(){return o(t,"Strip["+n+"]","Gain")}},GainLayer:function(e){return{set:function(r){return s(t,"Strip["+n+"]","GainLayer["+e+"]",r)},get:function(){return o(t,"Strip["+n+"]","GainLayer["+e+"]")}}},Pan_x:{set:function(e){return s(t,"Strip["+n+"]","Pan_x",e)},get:function(){return o(t,"Strip["+n+"]","Pan_x")}},Pan_y:{set:function(e){return s(t,"Strip["+n+"]","Pan_y",e)},get:function(){return o(t,"Strip["+n+"]","Pan_y")}},Color_x:{set:function(e){return s(t,"Strip["+n+"]","Color_x",e)},get:function(){return o(t,"Strip["+n+"]","Color_x")}},Color_y:{set:function(e){return s(t,"Strip["+n+"]","Color_y",e)},get:function(){return o(t,"Strip["+n+"]","Color_y")}},fx_x:{set:function(e){return s(t,"Strip["+n+"]","fx_x",e)},get:function(){return o(t,"Strip["+n+"]","fx_x")}},fx_y:{set:function(e){return s(t,"Strip["+n+"]","fx_y",e)},get:function(){return o(t,"Strip["+n+"]","fx_y")}},Audibility:{set:function(e){return s(t,"Strip["+n+"]","Audibility",e)},get:function(){return o(t,"Strip["+n+"]","Audibility")}},Comp:{GainIn:{set:function(e){return s(t,"Strip["+n+"]","Comp","GainIn",e)},get:function(){return o(t,"Strip["+n+"]","Comp","GainIn")}},Ratio:{set:function(e){return s(t,"Strip["+n+"]","Comp","Ratio",e)},get:function(){return o(t,"Strip["+n+"]","Comp","Ratio")}},Threshold:{set:function(e){return s(t,"Strip["+n+"]","Comp","Threshold",e)},get:function(){return o(t,"Strip["+n+"]","Comp","Threshold")}},Attack:{set:function(e){return s(t,"Strip["+n+"]","Comp","Attack",e)},get:function(){return o(t,"Strip["+n+"]","Comp","Attack")}},Release:{set:function(e){return s(t,"Strip["+n+"]","Comp","Release",e)},get:function(){return o(t,"Strip["+n+"]","Comp","Release")}},Knee:{set:function(e){return s(t,"Strip["+n+"]","Comp","Knee",e)},get:function(){return o(t,"Strip["+n+"]","Comp","Knee")}},GainOut:{set:function(e){return s(t,"Strip["+n+"]","Comp","GainOut",e)},get:function(){return o(t,"Strip["+n+"]","Comp","GainOut")}},MakeUp:{set:function(e){return s(t,"Strip["+n+"]","Comp","MakeUp",e)},get:function(){return o(t,"Strip["+n+"]","Comp","MakeUp")}}},Gate:{Threshold:{set:function(e){return s(t,"Strip["+n+"]","Gate","Threshold",e)},get:function(){return o(t,"Strip["+n+"]","Gate","Threshold")}},Damping:{set:function(e){return s(t,"Strip["+n+"]","Gate","Damping",e)},get:function(){return o(t,"Strip["+n+"]","Gate","Damping")}},BPSidechain:{set:function(e){return s(t,"Strip["+n+"]","Gate","BPSidechain",e)},get:function(){return o(t,"Strip["+n+"]","Gate","BPSidechain")}},Attack:{set:function(e){return s(t,"Strip["+n+"]","Gate","Attack",e)},get:function(){return o(t,"Strip["+n+"]","Gate","Attack")}},Hold:{set:function(e){return s(t,"Strip["+n+"]","Gate","Hold",e)},get:function(){return o(t,"Strip["+n+"]","Gate","Hold")}},Release:{set:function(e){return s(t,"Strip["+n+"]","Gate","Release",e)},get:function(){return o(t,"Strip["+n+"]","Gate","Release")}}},Denoiser:{Threshold:{set:function(e){return s(t,"Strip["+n+"]","Denoiser","Threshold",e)},get:function(){return o(t,"Strip["+n+"]","Denoiser","Threshold")}}},Pitch:{On:{set:function(e){return s(t,"Strip["+n+"]","Pitch","On",e)},get:function(){return o(t,"Strip["+n+"]","Pitch","On")}},DryWet:{set:function(e){return s(t,"Strip["+n+"]","Pitch","DryWet",e)},get:function(){return o(t,"Strip["+n+"]","Pitch","DryWet")}},PitchValue:{set:function(e){return s(t,"Strip["+n+"]","Pitch","PitchValue",e)},get:function(){return o(t,"Strip["+n+"]","Pitch","PitchValue")}},LoFormant:{set:function(e){return s(t,"Strip["+n+"]","Pitch","LoFormant",e)},get:function(){return o(t,"Strip["+n+"]","Pitch","LoFormant")}},MedFormant:{set:function(e){return s(t,"Strip["+n+"]","Pitch","MedFormant",e)},get:function(){return o(t,"Strip["+n+"]","Pitch","MedFormant")}},HiFormant:{set:function(e){return s(t,"Strip["+n+"]","Pitch","HiFormant",e)},get:function(){return o(t,"Strip["+n+"]","Pitch","HiFormant")}}},Karaoke:{set:function(e){return s(t,"Strip["+n+"]","Karaoke",e)},get:function(){return o(t,"Strip["+n+"]","Karaoke")}},Limit:{set:function(e){return s(t,"Strip["+n+"]","Limit",e)},get:function(){return o(t,"Strip["+n+"]","Limit")}},EQGain1:{set:function(e){return s(t,"Strip["+n+"]","EQGain1",e)},get:function(){return o(t,"Strip["+n+"]","EQGain1")}},EQGain2:{set:function(e){return s(t,"Strip["+n+"]","EQGain2",e)},get:function(){return o(t,"Strip["+n+"]","EQGain2")}},EQGain3:{set:function(e){return s(t,"Strip["+n+"]","EQGain3",e)},get:function(){return o(t,"Strip["+n+"]","EQGain3")}},Label:{set:function(e){return s(t,"Strip["+n+"]","Label",e)},get:function(){return o(t,"Strip["+n+"]","Label")}},A1:{set:function(e){return s(t,"Strip["+n+"]","A1",e)},get:function(){return o(t,"Strip["+n+"]","A1")}},A2:{set:function(e){return s(t,"Strip["+n+"]","A2",e)},get:function(){return o(t,"Strip["+n+"]","A2")}},A3:{set:function(e){return s(t,"Strip["+n+"]","A3",e)},get:function(){return o(t,"Strip["+n+"]","A3")}},A4:{set:function(e){return s(t,"Strip["+n+"]","A4",e)},get:function(){return o(t,"Strip["+n+"]","A4")}},A5:{set:function(e){return s(t,"Strip["+n+"]","A5",e)},get:function(){return o(t,"Strip["+n+"]","A5")}},B1:{set:function(e){return s(t,"Strip["+n+"]","B1",e)},get:function(){return o(t,"Strip["+n+"]","B1")}},B2:{set:function(e){return s(t,"Strip["+n+"]","B2",e)},get:function(){return o(t,"Strip["+n+"]","B2")}},B3:{set:function(e){return s(t,"Strip["+n+"]","B3",e)},get:function(){return o(t,"Strip["+n+"]","B3")}},FadeTo:{set:function(e){return s(t,"Strip["+n+"]","FadeTo",e)},get:function(){return o(t,"Strip["+n+"]","FadeTo")}},FadeBy:{set:function(e){return s(t,"Strip["+n+"]","FadeBy",e)},get:function(){return o(t,"Strip["+n+"]","FadeBy")}},Reverb:{set:function(e){return s(t,"Strip["+n+"]","Reverb",e)},get:function(){return o(t,"Strip["+n+"]","Reverb")}},Delay:{set:function(e){return s(t,"Strip["+n+"]","Delay",e)},get:function(){return o(t,"Strip["+n+"]","Delay")}},Fx1:{set:function(e){return s(t,"Strip["+n+"]","Fx1",e)},get:function(){return o(t,"Strip["+n+"]","Fx1")}},Fx2:{set:function(e){return s(t,"Strip["+n+"]","Fx2",e)},get:function(){return o(t,"Strip["+n+"]","Fx2")}},PostReverb:{set:function(e){return s(t,"Strip["+n+"]","PostReverb",e)},get:function(){return o(t,"Strip["+n+"]","PostReverb")}},PostDelay:{set:function(e){return s(t,"Strip["+n+"]","PostDelay",e)},get:function(){return o(t,"Strip["+n+"]","PostDelay")}},PostFx1:{set:function(e){return s(t,"Strip["+n+"]","PostFx1",e)},get:function(){return o(t,"Strip["+n+"]","PostFx1")}},PostFx2:{set:function(e){return s(t,"Strip["+n+"]","PostFx2",e)},get:function(){return o(t,"Strip["+n+"]","PostFx2")}},EQ:{on:{set:function(e){return s(t,"Strip["+n+"]","EQ","on",e)},get:function(){return o(t,"Strip["+n+"]","EQ","on")}},AB:{set:function(e){return s(t,"Strip["+n+"]","EQ","AB",e)},get:function(){return o(t,"Strip["+n+"]","EQ","AB")}},channel:function(e){return{cell:function(r){return{on:{set:function(u){return s(t,"Strip["+n+"]","EQ","channel["+e+"]","cell["+r+"]","on",u)},get:function(){return o(t,"Strip["+n+"]","EQ","channel["+e+"]","cell["+r+"]","on")}},type:{set:function(u){return s(t,"Strip["+n+"]","EQ","channel["+e+"]","cell["+r+"]","type",u)},get:function(){return o(t,"Strip["+n+"]","EQ","channel["+e+"]","cell["+r+"]","type")}},f:{set:function(u){return s(t,"Strip["+n+"]","EQ","channel["+e+"]","cell["+r+"]","f",u)},get:function(){return o(t,"Strip["+n+"]","EQ","channel["+e+"]","cell["+r+"]","f")}},gain:{set:function(u){return s(t,"Strip["+n+"]","EQ","channel["+e+"]","cell["+r+"]","gain",u)},get:function(){return o(t,"Strip["+n+"]","EQ","channel["+e+"]","cell["+r+"]","gain")}},q:{set:function(u){return s(t,"Strip["+n+"]","EQ","channel["+e+"]","cell["+r+"]","q",u)},get:function(){return o(t,"Strip["+n+"]","EQ","channel["+e+"]","cell["+r+"]","q")}}}}}}},VAIO:{set:function(e){return s(t,"Strip["+n+"]","VAIO",e)},get:function(){return o(t,"Strip["+n+"]","VAIO")}},App:function(e){return{Gain:{set:function(r){return s(t,"Strip["+n+"]","App["+e+"]","Gain",r)},get:function(){return o(t,"Strip["+n+"]","App["+e+"]","Gain")}},Mute:{set:function(r){return s(t,"Strip["+n+"]","App["+e+"]","Mute",r)},get:function(){return o(t,"Strip["+n+"]","App["+e+"]","Mute")}}}},AppGain:{set:function(e){return s(t,"Strip["+n+"]","AppGain",e)},get:function(){return o(t,"Strip["+n+"]","AppGain")}},AppMute:{set:function(e){return s(t,"Strip["+n+"]","AppMute",e)},get:function(){return o(t,"Strip["+n+"]","AppMute")}},device:{name:{set:function(e){return s(t,"Strip["+n+"]","device","name",e)},get:function(){return o(t,"Strip["+n+"]","device","name")}},sr:{set:function(e){return s(t,"Strip["+n+"]","device","sr",e)},get:function(){return o(t,"Strip["+n+"]","device","sr")}},wdm:{set:function(e){return s(t,"Strip["+n+"]","device","wdm",e)},get:function(){return o(t,"Strip["+n+"]","device","wdm")}},ks:{set:function(e){return s(t,"Strip["+n+"]","device","ks",e)},get:function(){return o(t,"Strip["+n+"]","device","ks")}},mme:{set:function(e){return s(t,"Strip["+n+"]","device","mme",e)},get:function(){return o(t,"Strip["+n+"]","device","mme")}},asio:{set:function(e){return s(t,"Strip["+n+"]","device","asio",e)},get:function(){return o(t,"Strip["+n+"]","device","asio")}}}}},Bus:function(n){return{Mono:{set:function(e){return s(t,"Bus["+n+"]","Mono",e)},get:function(){return o(t,"Bus["+n+"]","Mono")}},Mute:{set:function(e){return s(t,"Bus["+n+"]","Mute",e)},get:function(){return o(t,"Bus["+n+"]","Mute")}},EQ:{on:{set:function(e){return s(t,"Bus["+n+"]","EQ","on",e)},get:function(){return o(t,"Bus["+n+"]","EQ","on")}},AB:{set:function(e){return s(t,"Bus["+n+"]","EQ","AB",e)},get:function(){return o(t,"Bus["+n+"]","EQ","AB")}},channel:function(e){return{cell:function(r){return{on:{set:function(u){return s(t,"Bus["+n+"]","EQ","channel["+e+"]","cell["+r+"]","on",u)},get:function(){return o(t,"Bus["+n+"]","EQ","channel["+e+"]","cell["+r+"]","on")}},type:{set:function(u){return s(t,"Bus["+n+"]","EQ","channel["+e+"]","cell["+r+"]","type",u)},get:function(){return o(t,"Bus["+n+"]","EQ","channel["+e+"]","cell["+r+"]","type")}},f:{set:function(u){return s(t,"Bus["+n+"]","EQ","channel["+e+"]","cell["+r+"]","f",u)},get:function(){return o(t,"Bus["+n+"]","EQ","channel["+e+"]","cell["+r+"]","f")}},gain:{set:function(u){return s(t,"Bus["+n+"]","EQ","channel["+e+"]","cell["+r+"]","gain",u)},get:function(){return o(t,"Bus["+n+"]","EQ","channel["+e+"]","cell["+r+"]","gain")}},q:{set:function(u){return s(t,"Bus["+n+"]","EQ","channel["+e+"]","cell["+r+"]","q",u)},get:function(){return o(t,"Bus["+n+"]","EQ","channel["+e+"]","cell["+r+"]","q")}}}}}}},Gain:{set:function(e){return s(t,"Bus["+n+"]","Gain",e)},get:function(){return o(t,"Bus["+n+"]","Gain")}},Label:{set:function(e){return s(t,"Bus["+n+"]","Label",e)},get:function(){return o(t,"Bus["+n+"]","Label")}},mode:{normal:{set:function(e){return s(t,"Bus["+n+"]","mode","normal",e)},get:function(){return o(t,"Bus["+n+"]","mode","normal")}},Amix:{set:function(e){return s(t,"Bus["+n+"]","mode","Amix",e)},get:function(){return o(t,"Bus["+n+"]","mode","Amix")}},Bmix:{set:function(e){return s(t,"Bus["+n+"]","mode","Bmix",e)},get:function(){return o(t,"Bus["+n+"]","mode","Bmix")}},Repeat:{set:function(e){return s(t,"Bus["+n+"]","mode","Repeat",e)},get:function(){return o(t,"Bus["+n+"]","mode","Repeat")}},Composite:{set:function(e){return s(t,"Bus["+n+"]","mode","Composite",e)},get:function(){return o(t,"Bus["+n+"]","mode","Composite")}},TVMix:{set:function(e){return s(t,"Bus["+n+"]","mode","TVMix",e)},get:function(){return o(t,"Bus["+n+"]","mode","TVMix")}},UpMix21:{set:function(e){return s(t,"Bus["+n+"]","mode","UpMix21",e)},get:function(){return o(t,"Bus["+n+"]","mode","UpMix21")}},UpMix41:{set:function(e){return s(t,"Bus["+n+"]","mode","UpMix41",e)},get:function(){return o(t,"Bus["+n+"]","mode","UpMix41")}},UpMix61:{set:function(e){return s(t,"Bus["+n+"]","mode","UpMix61",e)},get:function(){return o(t,"Bus["+n+"]","mode","UpMix61")}},CenterOnly:{set:function(e){return s(t,"Bus["+n+"]","mode","CenterOnly",e)},get:function(){return o(t,"Bus["+n+"]","mode","CenterOnly")}},LFEOnly:{set:function(e){return s(t,"Bus["+n+"]","mode","LFEOnly",e)},get:function(){return o(t,"Bus["+n+"]","mode","LFEOnly")}},RearOnly:{set:function(e){return s(t,"Bus["+n+"]","mode","RearOnly",e)},get:function(){return o(t,"Bus["+n+"]","mode","RearOnly")}}},FadeTo:{set:function(e){return s(t,"Bus["+n+"]","FadeTo",e)},get:function(){return o(t,"Bus["+n+"]","FadeTo")}},FadeBy:{set:function(e){return s(t,"Bus["+n+"]","FadeBy",e)},get:function(){return o(t,"Bus["+n+"]","FadeBy")}},Sel:{set:function(e){return s(t,"Bus["+n+"]","Sel",e)},get:function(){return o(t,"Bus["+n+"]","Sel")}},ReturnReverb:{set:function(e){return s(t,"Bus["+n+"]","ReturnReverb",e)},get:function(){return o(t,"Bus["+n+"]","ReturnReverb")}},ReturnDelay:{set:function(e){return s(t,"Bus["+n+"]","ReturnDelay",e)},get:function(){return o(t,"Bus["+n+"]","ReturnDelay")}},ReturnFx1:{set:function(e){return s(t,"Bus["+n+"]","ReturnFx1",e)},get:function(){return o(t,"Bus["+n+"]","ReturnFx1")}},ReturnFx2:{set:function(e){return s(t,"Bus["+n+"]","ReturnFx2",e)},get:function(){return o(t,"Bus["+n+"]","ReturnFx2")}},Monitor:{set:function(e){return s(t,"Bus["+n+"]","Monitor",e)},get:function(){return o(t,"Bus["+n+"]","Monitor")}},VAIO:{set:function(e){return s(t,"Bus["+n+"]","VAIO",e)},get:function(){return o(t,"Bus["+n+"]","VAIO")}},device:{name:{set:function(e){return s(t,"Bus["+n+"]","device","name",e)},get:function(){return o(t,"Bus["+n+"]","device","name")}},sr:{set:function(e){return s(t,"Bus["+n+"]","device","sr",e)},get:function(){return o(t,"Bus["+n+"]","device","sr")}},wdm:{set:function(e){return s(t,"Bus["+n+"]","device","wdm",e)},get:function(){return o(t,"Bus["+n+"]","device","wdm")}},ks:{set:function(e){return s(t,"Bus["+n+"]","device","ks",e)},get:function(){return o(t,"Bus["+n+"]","device","ks")}},mme:{set:function(e){return s(t,"Bus["+n+"]","device","mme",e)},get:function(){return o(t,"Bus["+n+"]","device","mme")}},asio:{set:function(e){return s(t,"Bus["+n+"]","device","asio",e)},get:function(){return o(t,"Bus["+n+"]","device","asio")}}}}},Fx:{Reverb:{On:{set:function(n){return s(t,"Fx","Reverb","On",n)},get:function(){return o(t,"Fx","Reverb","On")}},AB:{set:function(n){return s(t,"Fx","Reverb","AB",n)},get:function(){return o(t,"Fx","Reverb","AB")}}},Delay:{On:{set:function(n){return s(t,"Fx","Delay","On",n)},get:function(){return o(t,"Fx","Delay","On")}},AB:{set:function(n){return s(t,"Fx","Delay","AB",n)},get:function(){return o(t,"Fx","Delay","AB")}}}},patch:{asio:function(n){return{set:function(e){return s(t,"patch","asio["+n+"]",e)},get:function(){return o(t,"patch","asio["+n+"]")}}},OutA2:function(n){return{set:function(e){return s(t,"patch","OutA2["+n+"]",e)},get:function(){return o(t,"patch","OutA2["+n+"]")}}},OutA3:function(n){return{set:function(e){return s(t,"patch","OutA3["+n+"]",e)},get:function(){return o(t,"patch","OutA3["+n+"]")}}},OutA4:function(n){return{set:function(e){return s(t,"patch","OutA4["+n+"]",e)},get:function(){return o(t,"patch","OutA4["+n+"]")}}},OutA5:function(n){return{set:function(e){return s(t,"patch","OutA5["+n+"]",e)},get:function(){return o(t,"patch","OutA5["+n+"]")}}},composite:function(n){return{set:function(e){return s(t,"Patch","composite["+n+"]",e)},get:function(){return o(t,"Patch","composite["+n+"]")}}},insert:function(n){return{set:function(e){return s(t,"Patch","insert["+n+"]",e)},get:function(){return o(t,"Patch","insert["+n+"]")}}},PostFaderComposite:{set:function(n){return s(t,"Patch","PostFaderComposite",n)},get:function(){return o(t,"Patch","PostFaderComposite")}},PostFxInsert:{set:function(n){return s(t,"Patch","PostFxInsert",n)},get:function(){return o(t,"Patch","PostFxInsert")}}},Option:{sr:{set:function(n){return s(t,"Option","sr",n)},get:function(){return o(t,"Option","sr")}},ASIOsr:{set:function(n){return s(t,"Option","ASIOsr",n)},get:function(){return o(t,"Option","ASIOsr")}},delay:function(n){return{set:function(e){return s(t,"Option","delay["+n+"]",e)},get:function(){return o(t,"Option","delay["+n+"]")}}},buffer:{mme:{set:function(n){return s(t,"Option","buffer","mme",n)},get:function(){return o(t,"Option","buffer","mme")}},wdm:{set:function(n){return s(t,"Option","buffer","wdm",n)},get:function(){return o(t,"Option","buffer","wdm")}},ks:{set:function(n){return s(t,"Option","buffer","ks",n)},get:function(){return o(t,"Option","buffer","ks")}},asio:{set:function(n){return s(t,"Option","buffer","asio",n)},get:function(){return o(t,"Option","buffer","asio")}}},mode:{exclusif:{set:function(n){return s(t,"Option","mode","exclusif",n)},get:function(){return o(t,"Option","mode","exclusif")}},swift:{set:function(n){return s(t,"Option","mode","swift",n)},get:function(){return o(t,"Option","mode","swift")}}},MonitorOnSEL:{set:function(n){return s(t,"Option","MonitorOnSEL",n)},get:function(){return o(t,"Option","MonitorOnSEL")}},SliderMode:{set:function(n){return s(t,"Option","SliderMode",n)},get:function(){return o(t,"Option","SliderMode")}}},recorder:{stop:{set:function(n){return s(t,"recorder","stop",n)},get:function(){return o(t,"recorder","stop")}},play:{set:function(n){return s(t,"recorder","play",n)},get:function(){return o(t,"recorder","play")}},replay:{set:function(n){return s(t,"recorder","replay",n)},get:function(){return o(t,"recorder","replay")}},ff:{set:function(n){return s(t,"recorder","ff",n)},get:function(){return o(t,"recorder","ff")}},rew:{set:function(n){return s(t,"recorder","rew",n)},get:function(){return o(t,"recorder","rew")}},A1:{set:function(n){return s(t,"recorder","A1",n)},get:function(){return o(t,"recorder","A1")}},A2:{set:function(n){return s(t,"recorder","A2",n)},get:function(){return o(t,"recorder","A2")}},A3:{set:function(n){return s(t,"recorder","A3",n)},get:function(){return o(t,"recorder","A3")}},A4:{set:function(n){return s(t,"recorder","A4",n)},get:function(){return o(t,"recorder","A4")}},A5:{set:function(n){return s(t,"recorder","A5",n)},get:function(){return o(t,"recorder","A5")}},B1:{set:function(n){return s(t,"recorder","B1",n)},get:function(){return o(t,"recorder","B1")}},B2:{set:function(n){return s(t,"recorder","B2",n)},get:function(){return o(t,"recorder","B2")}},B3:{set:function(n){return s(t,"recorder","B3",n)},get:function(){return o(t,"recorder","B3")}},record:{set:function(n){return s(t,"recorder","record",n)},get:function(){return o(t,"recorder","record")}},pause:{set:function(n){return s(t,"recorder","pause",n)},get:function(){return o(t,"recorder","pause")}},goto:{set:function(n){return s(t,"Recorder","goto",n)},get:function(){return o(t,"Recorder","goto")}},load:{set:function(n){return s(t,"Recorder","load",n)},get:function(){return o(t,"Recorder","load")}},samplerate:{set:function(n){return s(t,"Recorder","samplerate",n)},get:function(){return o(t,"Recorder","samplerate")}},ArmStrip:function(n){return{set:function(e){return s(t,"Recorder","ArmStrip("+n+")",e)},get:function(){return o(t,"Recorder","ArmStrip("+n+")")}}},ArmBus:function(n){return{set:function(e){return s(t,"Recorder","ArmBus("+n+")",e)},get:function(){return o(t,"Recorder","ArmBus("+n+")")}}},mode:{recbus:{set:function(n){return s(t,"Recorder","mode","recbus",n)},get:function(){return o(t,"Recorder","mode","recbus")}},PlayOnLoad:{set:function(n){return s(t,"Recorder","mode","PlayOnLoad",n)},get:function(){return o(t,"Recorder","mode","PlayOnLoad")}},Loop:{set:function(n){return s(t,"Recorder","mode","Loop",n)},get:function(){return o(t,"Recorder","mode","Loop")}},MultiTrack:{set:function(n){return s(t,"Recorder","mode","MultiTrack",n)},get:function(){return o(t,"Recorder","mode","MultiTrack")}}},bitResolution:{set:function(n){return s(t,"Recorder","bitResolution",n)},get:function(){return o(t,"Recorder","bitResolution")}},Channel:{set:function(n){return s(t,"Recorder","Channel",n)},get:function(){return o(t,"Recorder","Channel")}},kbps:{set:function(n){return s(t,"Recorder","kbps",n)},get:function(){return o(t,"Recorder","kbps")}},FileType:{set:function(n){return s(t,"Recorder","FileType",n)},get:function(){return o(t,"Recorder","FileType")}},gain:{set:function(n){return s(t,"Recorder","gain",n)},get:function(){return o(t,"Recorder","gain")}}},vban:{Enable:{set:function(n){return s(t,"vban","Enable",n)},get:function(){return o(t,"vban","Enable")}},instream:function(n){return{on:{set:function(e){return s(t,"vban","instream["+n+"]","on",e)},get:function(){return o(t,"vban","instream["+n+"]","on")}},name:{set:function(e){return s(t,"vban","instream["+n+"]","name",e)},get:function(){return o(t,"vban","instream["+n+"]","name")}},ip:{set:function(e){return s(t,"vban","instream["+n+"]","ip",e)},get:function(){return o(t,"vban","instream["+n+"]","ip")}},port:{set:function(e){return s(t,"vban","instream["+n+"]","port",e)},get:function(){return o(t,"vban","instream["+n+"]","port")}},sr:{set:function(e){return s(t,"vban","instream["+n+"]","sr",e)},get:function(){return o(t,"vban","instream["+n+"]","sr")}},channel:{set:function(e){return s(t,"vban","instream["+n+"]","channel",e)},get:function(){return o(t,"vban","instream["+n+"]","channel")}},bit:{set:function(e){return s(t,"vban","instream["+n+"]","bit",e)},get:function(){return o(t,"vban","instream["+n+"]","bit")}},quality:{set:function(e){return s(t,"vban","instream["+n+"]","quality",e)},get:function(){return o(t,"vban","instream["+n+"]","quality")}},route:{set:function(e){return s(t,"vban","instream["+n+"]","route",e)},get:function(){return o(t,"vban","instream["+n+"]","route")}}}},outstream:function(n){return{on:{set:function(e){return s(t,"vban","outstream["+n+"]","on",e)},get:function(){return o(t,"vban","outstream["+n+"]","on")}},name:{set:function(e){return s(t,"vban","outstream["+n+"]","name",e)},get:function(){return o(t,"vban","outstream["+n+"]","name")}},ip:{set:function(e){return s(t,"vban","outstream["+n+"]","ip",e)},get:function(){return o(t,"vban","outstream["+n+"]","ip")}},port:{set:function(e){return s(t,"vban","outstream["+n+"]","port",e)},get:function(){return o(t,"vban","outstream["+n+"]","port")}},sr:{set:function(e){return s(t,"vban","outstream["+n+"]","sr",e)},get:function(){return o(t,"vban","outstream["+n+"]","sr")}},channel:{set:function(e){return s(t,"vban","outstream["+n+"]","channel",e)},get:function(){return o(t,"vban","outstream["+n+"]","channel")}},bit:{set:function(e){return s(t,"vban","outstream["+n+"]","bit",e)},get:function(){return o(t,"vban","outstream["+n+"]","bit")}},quality:{set:function(e){return s(t,"vban","outstream["+n+"]","quality",e)},get:function(){return o(t,"vban","outstream["+n+"]","quality")}},route:{set:function(e){return s(t,"vban","outstream["+n+"]","route",e)},get:function(){return o(t,"vban","outstream["+n+"]","route")}}}}}}),this.attachChangeEvent=function(t){n.eventPool.push(t)},this.getOption=function(t){if(!n.isConnected)throw new Error("Not correct connected ");if(n.stringParameters.some(function(n){return t.includes(n)})){var e=Buffer.alloc(512);return i.VBVMR_GetParameterStringA(t,e),String.fromCharCode.apply(null,e).split("").filter(function(t){return"\0"!==t}).join("")}var r=[0];return i.VBVMR_GetParameterFloat(t,r),r[0]},this.setOption=function(t){var n=Buffer.alloc(t.length+1);return n.fill(0).write(t),i.VBVMR_SetParameters(n),new Promise(function(t){return setTimeout(t,200)})},this.checkPropertyChange=function(){1===n.isParametersDirty()&&n.eventPool.forEach(function(t){t()})},this.getVoicemeeterType=function(){var t=[0];if(0!==i.VBVMR_GetVoicemeeterType(t))throw new Error("running failed");switch(t[0]){case 1:return"voicemeeter";case 2:return"voicemeeterBanana";case 3:return"voicemeeterPotato";default:throw new Error("Voicemeeter seems not to be installed")}},this.getVoicemeeterVersion=function(){var t=[0];if(0!==i.VBVMR_GetVoicemeeterVersion(t))throw new Error("running failed");return((4278190080&t[0])>>24)+"."+((16711680&t[0])>>16)+"."+((65280&t[0])>>8)+"."+(255&t[0])},this.getLevel=function(t,n){var e=[0];return i.VBVMR_GetLevel(t,n,e),e[0]}}var n;return t.init=function(){try{return Promise.resolve(function(){try{var t=new u.default({hive:u.default.HKLM,key:"\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\VB:Voicemeeter {17359A74-1236-5467}"});return Promise.resolve(new Promise(function(n){t.values(function(t,e){if(t)throw new Error(t);var r=e.find(function(t){return"UninstallString"===t.name}).value,u=r.lastIndexOf("\\");n(r.slice(0,u))})}))}catch(t){return Promise.reject(t)}}()).then(function(n){return new Promise(function(e){c||(c=new t);var u=r.default.load(n+"/VoicemeeterRemote64.dll");i={VBVMR_Login:u.func("long __stdcall VBVMR_Login(void)"),VBVMR_Logout:u.func("long __stdcall VBVMR_Logout(void)"),VBVMR_RunVoicemeeter:u.func("long __stdcall VBVMR_RunVoicemeeter(long mode)"),VBVMR_IsParametersDirty:u.func("long __stdcall VBVMR_IsParametersDirty(void)"),VBVMR_GetLevel:u.func("long __stdcall VBVMR_GetLevel(long type, long channel, _Out_ float* value)"),VBVMR_GetParameterFloat:u.func("long __stdcall VBVMR_GetParameterFloat(const char* param, _Out_ float* value)"),VBVMR_GetParameterStringA:u.func("long __stdcall VBVMR_GetParameterStringA(const char* param, _Out_ char* value)"),VBVMR_SetParameters:u.func("long __stdcall VBVMR_SetParameters(const char* param)"),VBVMR_Output_GetDeviceNumber:u.func("long __stdcall VBVMR_Output_GetDeviceNumber(void)"),VBVMR_Output_GetDeviceDescA:u.func("long __stdcall VBVMR_Output_GetDeviceDescA(long index, _Out_ long* type, _Out_ char* name, _Out_ char* hardwareId)"),VBVMR_Input_GetDeviceNumber:u.func("long __stdcall VBVMR_Input_GetDeviceNumber(void)"),VBVMR_Input_GetDeviceDescA:u.func("long __stdcall VBVMR_Input_GetDeviceDescA(long index, long* type, char* name, char* hardwareId)"),VBVMR_GetVoicemeeterType:u.func("long __stdcall VBVMR_GetVoicemeeterType(_Out_ long* type)"),VBVMR_GetVoicemeeterVersion:u.func("long __stdcall VBVMR_GetVoicemeeterVersion(_Out_ long* version)")},c.isInitialised=!0,e(c)})})}catch(t){return Promise.reject(t)}},(n=[{key:"$outputDevices",get:function(){return this.outputDevices}},{key:"$inputDevices",get:function(){return this.inputDevices}},{key:"$version",get:function(){return this.version}},{key:"$type",get:function(){return this.type}}])&&function(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(t.prototype,n),t}(),exports.types={__proto__:null};
//# sourceMappingURL=index.js.map
