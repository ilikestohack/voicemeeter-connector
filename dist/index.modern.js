import e from"koffi";import t from"winreg";function r(e,...t){return e.getOption(t.join("."))}async function o(e,...t){if(!e.isConnected)throw new Error("Not connected ");const o=t[t.length-1];return t.pop(),await e.setOption(`${t.join(".")}=${o}`),r(e,...t)}let i,s;class n{constructor(){var e;this.isConnected=!1,this.isInitialised=!1,this.outputDevices=[],this.inputDevices=[],this.version="",this.type=void 0,this.eventPool=[],this.stringParameters=["Label","FadeTo","FadeBy","AppGain","AppMute","name","ip"],this.connect=()=>{if(!this.isInitialised)throw new Error("Await the initialisation before connect");if(!this.isConnected){if(0===i.VBVMR_Login())return this.isConnected=!0,this.type=this.getVoicemeeterType(),this.version=this.getVoicemeeterVersion(),void setInterval(this.checkPropertyChange,10);throw this.isConnected=!1,new Error("Connection failed")}},this.disconnect=()=>{if(!this.isConnected)throw new Error("Not connected ");try{if(0===i.VBVMR_Logout())return void(this.isConnected=!1);throw new Error("Disconnect failed")}catch(e){throw new Error("Disconnect failed")}},this.updateDeviceList=()=>{if(!this.isConnected)throw new Error("Not connected ");this.outputDevices=[],this.inputDevices=[];const e=i.VBVMR_Output_GetDeviceNumber();for(let t=0;t<e;t++){const e=Buffer.alloc(256),r=Buffer.alloc(256),o=[0];i.VBVMR_Output_GetDeviceDescA(t,o,r,e),this.outputDevices.push({name:r.toString().replace(/\u0000+$/g,""),hardwareId:e.toString().replace(/\u0000+$/g,""),type:o[0]})}const t=i.VBVMR_Input_GetDeviceNumber();for(let e=0;e<t;e++){const t=Buffer.alloc(256),r=Buffer.alloc(256),o=[0];i.VBVMR_Input_GetDeviceDescA(e,o,r,t),this.inputDevices.push({name:r.toString().replace(/\u0000+$/g,""),hardwareId:t.toString().replace(/\u0000+$/g,""),type:o[0]})}},this.isParametersDirty=()=>i.VBVMR_IsParametersDirty(),this.parameters=(e=this,{Command:{Shutdown:{set:t=>o(e,"Command","Shutdown",t),get:()=>r(e,"Command","Shutdown")},Show:{set:t=>o(e,"Command","Show",t),get:()=>r(e,"Command","Show")},Restart:{set:t=>o(e,"Command","Restart",t),get:()=>r(e,"Command","Restart")},Eject:{set:t=>o(e,"Command","Eject",t),get:()=>r(e,"Command","Eject")},Reset:{set:t=>o(e,"Command","Reset",t),get:()=>r(e,"Command","Reset")},Save:{set:t=>o(e,"Command","Save",t),get:()=>r(e,"Command","Save")},Load:{set:t=>o(e,"Command","Load",t),get:()=>r(e,"Command","Load")},Lock:{set:t=>o(e,"Command","Lock",t),get:()=>r(e,"Command","Lock")},Button:t=>({State:{set:r=>o(e,"Command",`Button[${t}]`,"State",r),get:()=>r(e,"Command",`Button[${t}]`,"State")},StateOnly:{set:r=>o(e,"Command",`Button[${t}]`,"StateOnly",r),get:()=>r(e,"Command",`Button[${t}]`,"StateOnly")},Trigger:{set:r=>o(e,"Command",`Button[${t}]`,"Trigger",r),get:()=>r(e,"Command",`Button[${t}]`,"Trigger")},Color:{set:r=>o(e,"Command",`Button[${t}]`,"Color",r),get:()=>r(e,"Command",`Button[${t}]`,"Color")}}),DialogShow:{VBANCHAT:{set:t=>o(e,"Command","DialogShow","VBANCHAT",t),get:()=>r(e,"Command","DialogShow","VBANCHAT")}},SaveBUSEQ:t=>({set:r=>o(e,"Command",`SaveBUSEQ[${t}]`,r),get:()=>r(e,"Command",`SaveBUSEQ[${t}]`)}),LoadBUSEQ:t=>({set:r=>o(e,"Command",`LoadBUSEQ[${t}]`,r),get:()=>r(e,"Command",`LoadBUSEQ[${t}]`)}),SaveStripEQ:t=>({set:r=>o(e,"Command",`SaveStripEQ[${t}]`,r),get:()=>r(e,"Command",`SaveStripEQ[${t}]`)}),LoadStripEQ:t=>({set:r=>o(e,"Command",`LoadStripEQ[${t}]`,r),get:()=>r(e,"Command",`LoadStripEQ[${t}]`)}),Preset:t=>({Recall:{set:r=>o(e,"Command",`Preset[${t}]`,"Recall",r),get:()=>r(e,"Command",`Preset[${t}]`,"Recall")}})},Strip:t=>({Mono:{set:r=>o(e,`Strip[${t}]`,"Mono",r),get:()=>r(e,`Strip[${t}]`,"Mono")},Mute:{set:r=>o(e,`Strip[${t}]`,"Mute",r),get:()=>r(e,`Strip[${t}]`,"Mute")},Solo:{set:r=>o(e,`Strip[${t}]`,"Solo",r),get:()=>r(e,`Strip[${t}]`,"Solo")},MC:{set:r=>o(e,`Strip[${t}]`,"MC",r),get:()=>r(e,`Strip[${t}]`,"MC")},Gain:{set:r=>o(e,`Strip[${t}]`,"Gain",r),get:()=>r(e,`Strip[${t}]`,"Gain")},GainLayer:i=>({set:r=>o(e,`Strip[${t}]`,`GainLayer[${i}]`,r),get:()=>r(e,`Strip[${t}]`,`GainLayer[${i}]`)}),Pan_x:{set:r=>o(e,`Strip[${t}]`,"Pan_x",r),get:()=>r(e,`Strip[${t}]`,"Pan_x")},Pan_y:{set:r=>o(e,`Strip[${t}]`,"Pan_y",r),get:()=>r(e,`Strip[${t}]`,"Pan_y")},Color_x:{set:r=>o(e,`Strip[${t}]`,"Color_x",r),get:()=>r(e,`Strip[${t}]`,"Color_x")},Color_y:{set:r=>o(e,`Strip[${t}]`,"Color_y",r),get:()=>r(e,`Strip[${t}]`,"Color_y")},fx_x:{set:r=>o(e,`Strip[${t}]`,"fx_x",r),get:()=>r(e,`Strip[${t}]`,"fx_x")},fx_y:{set:r=>o(e,`Strip[${t}]`,"fx_y",r),get:()=>r(e,`Strip[${t}]`,"fx_y")},Audibility:{set:r=>o(e,`Strip[${t}]`,"Audibility",r),get:()=>r(e,`Strip[${t}]`,"Audibility")},Comp:{GainIn:{set:r=>o(e,`Strip[${t}]`,"Comp","GainIn",r),get:()=>r(e,`Strip[${t}]`,"Comp","GainIn")},Ratio:{set:r=>o(e,`Strip[${t}]`,"Comp","Ratio",r),get:()=>r(e,`Strip[${t}]`,"Comp","Ratio")},Threshold:{set:r=>o(e,`Strip[${t}]`,"Comp","Threshold",r),get:()=>r(e,`Strip[${t}]`,"Comp","Threshold")},Attack:{set:r=>o(e,`Strip[${t}]`,"Comp","Attack",r),get:()=>r(e,`Strip[${t}]`,"Comp","Attack")},Release:{set:r=>o(e,`Strip[${t}]`,"Comp","Release",r),get:()=>r(e,`Strip[${t}]`,"Comp","Release")},Knee:{set:r=>o(e,`Strip[${t}]`,"Comp","Knee",r),get:()=>r(e,`Strip[${t}]`,"Comp","Knee")},GainOut:{set:r=>o(e,`Strip[${t}]`,"Comp","GainOut",r),get:()=>r(e,`Strip[${t}]`,"Comp","GainOut")},MakeUp:{set:r=>o(e,`Strip[${t}]`,"Comp","MakeUp",r),get:()=>r(e,`Strip[${t}]`,"Comp","MakeUp")}},Gate:{Threshold:{set:r=>o(e,`Strip[${t}]`,"Gate","Threshold",r),get:()=>r(e,`Strip[${t}]`,"Gate","Threshold")},Damping:{set:r=>o(e,`Strip[${t}]`,"Gate","Damping",r),get:()=>r(e,`Strip[${t}]`,"Gate","Damping")},BPSidechain:{set:r=>o(e,`Strip[${t}]`,"Gate","BPSidechain",r),get:()=>r(e,`Strip[${t}]`,"Gate","BPSidechain")},Attack:{set:r=>o(e,`Strip[${t}]`,"Gate","Attack",r),get:()=>r(e,`Strip[${t}]`,"Gate","Attack")},Hold:{set:r=>o(e,`Strip[${t}]`,"Gate","Hold",r),get:()=>r(e,`Strip[${t}]`,"Gate","Hold")},Release:{set:r=>o(e,`Strip[${t}]`,"Gate","Release",r),get:()=>r(e,`Strip[${t}]`,"Gate","Release")}},Denoiser:{Threshold:{set:r=>o(e,`Strip[${t}]`,"Denoiser","Threshold",r),get:()=>r(e,`Strip[${t}]`,"Denoiser","Threshold")}},Pitch:{On:{set:r=>o(e,`Strip[${t}]`,"Pitch","On",r),get:()=>r(e,`Strip[${t}]`,"Pitch","On")},DryWet:{set:r=>o(e,`Strip[${t}]`,"Pitch","DryWet",r),get:()=>r(e,`Strip[${t}]`,"Pitch","DryWet")},PitchValue:{set:r=>o(e,`Strip[${t}]`,"Pitch","PitchValue",r),get:()=>r(e,`Strip[${t}]`,"Pitch","PitchValue")},LoFormant:{set:r=>o(e,`Strip[${t}]`,"Pitch","LoFormant",r),get:()=>r(e,`Strip[${t}]`,"Pitch","LoFormant")},MedFormant:{set:r=>o(e,`Strip[${t}]`,"Pitch","MedFormant",r),get:()=>r(e,`Strip[${t}]`,"Pitch","MedFormant")},HiFormant:{set:r=>o(e,`Strip[${t}]`,"Pitch","HiFormant",r),get:()=>r(e,`Strip[${t}]`,"Pitch","HiFormant")}},Karaoke:{set:r=>o(e,`Strip[${t}]`,"Karaoke",r),get:()=>r(e,`Strip[${t}]`,"Karaoke")},Limit:{set:r=>o(e,`Strip[${t}]`,"Limit",r),get:()=>r(e,`Strip[${t}]`,"Limit")},EQGain1:{set:r=>o(e,`Strip[${t}]`,"EQGain1",r),get:()=>r(e,`Strip[${t}]`,"EQGain1")},EQGain2:{set:r=>o(e,`Strip[${t}]`,"EQGain2",r),get:()=>r(e,`Strip[${t}]`,"EQGain2")},EQGain3:{set:r=>o(e,`Strip[${t}]`,"EQGain3",r),get:()=>r(e,`Strip[${t}]`,"EQGain3")},Label:{set:r=>o(e,`Strip[${t}]`,"Label",r),get:()=>r(e,`Strip[${t}]`,"Label")},A1:{set:r=>o(e,`Strip[${t}]`,"A1",r),get:()=>r(e,`Strip[${t}]`,"A1")},A2:{set:r=>o(e,`Strip[${t}]`,"A2",r),get:()=>r(e,`Strip[${t}]`,"A2")},A3:{set:r=>o(e,`Strip[${t}]`,"A3",r),get:()=>r(e,`Strip[${t}]`,"A3")},A4:{set:r=>o(e,`Strip[${t}]`,"A4",r),get:()=>r(e,`Strip[${t}]`,"A4")},A5:{set:r=>o(e,`Strip[${t}]`,"A5",r),get:()=>r(e,`Strip[${t}]`,"A5")},B1:{set:r=>o(e,`Strip[${t}]`,"B1",r),get:()=>r(e,`Strip[${t}]`,"B1")},B2:{set:r=>o(e,`Strip[${t}]`,"B2",r),get:()=>r(e,`Strip[${t}]`,"B2")},B3:{set:r=>o(e,`Strip[${t}]`,"B3",r),get:()=>r(e,`Strip[${t}]`,"B3")},FadeTo:{set:r=>o(e,`Strip[${t}]`,"FadeTo",r),get:()=>r(e,`Strip[${t}]`,"FadeTo")},FadeBy:{set:r=>o(e,`Strip[${t}]`,"FadeBy",r),get:()=>r(e,`Strip[${t}]`,"FadeBy")},Reverb:{set:r=>o(e,`Strip[${t}]`,"Reverb",r),get:()=>r(e,`Strip[${t}]`,"Reverb")},Delay:{set:r=>o(e,`Strip[${t}]`,"Delay",r),get:()=>r(e,`Strip[${t}]`,"Delay")},Fx1:{set:r=>o(e,`Strip[${t}]`,"Fx1",r),get:()=>r(e,`Strip[${t}]`,"Fx1")},Fx2:{set:r=>o(e,`Strip[${t}]`,"Fx2",r),get:()=>r(e,`Strip[${t}]`,"Fx2")},PostReverb:{set:r=>o(e,`Strip[${t}]`,"PostReverb",r),get:()=>r(e,`Strip[${t}]`,"PostReverb")},PostDelay:{set:r=>o(e,`Strip[${t}]`,"PostDelay",r),get:()=>r(e,`Strip[${t}]`,"PostDelay")},PostFx1:{set:r=>o(e,`Strip[${t}]`,"PostFx1",r),get:()=>r(e,`Strip[${t}]`,"PostFx1")},PostFx2:{set:r=>o(e,`Strip[${t}]`,"PostFx2",r),get:()=>r(e,`Strip[${t}]`,"PostFx2")},EQ:{on:{set:r=>o(e,`Strip[${t}]`,"EQ","on",r),get:()=>r(e,`Strip[${t}]`,"EQ","on")},AB:{set:r=>o(e,`Strip[${t}]`,"EQ","AB",r),get:()=>r(e,`Strip[${t}]`,"EQ","AB")},channel:i=>({cell:s=>({on:{set:r=>o(e,`Strip[${t}]`,"EQ",`channel[${i}]`,`cell[${s}]`,"on",r),get:()=>r(e,`Strip[${t}]`,"EQ",`channel[${i}]`,`cell[${s}]`,"on")},type:{set:r=>o(e,`Strip[${t}]`,"EQ",`channel[${i}]`,`cell[${s}]`,"type",r),get:()=>r(e,`Strip[${t}]`,"EQ",`channel[${i}]`,`cell[${s}]`,"type")},f:{set:r=>o(e,`Strip[${t}]`,"EQ",`channel[${i}]`,`cell[${s}]`,"f",r),get:()=>r(e,`Strip[${t}]`,"EQ",`channel[${i}]`,`cell[${s}]`,"f")},gain:{set:r=>o(e,`Strip[${t}]`,"EQ",`channel[${i}]`,`cell[${s}]`,"gain",r),get:()=>r(e,`Strip[${t}]`,"EQ",`channel[${i}]`,`cell[${s}]`,"gain")},q:{set:r=>o(e,`Strip[${t}]`,"EQ",`channel[${i}]`,`cell[${s}]`,"q",r),get:()=>r(e,`Strip[${t}]`,"EQ",`channel[${i}]`,`cell[${s}]`,"q")}})})},VAIO:{set:r=>o(e,`Strip[${t}]`,"VAIO",r),get:()=>r(e,`Strip[${t}]`,"VAIO")},App:i=>({Gain:{set:r=>o(e,`Strip[${t}]`,`App[${i}]`,"Gain",r),get:()=>r(e,`Strip[${t}]`,`App[${i}]`,"Gain")},Mute:{set:r=>o(e,`Strip[${t}]`,`App[${i}]`,"Mute",r),get:()=>r(e,`Strip[${t}]`,`App[${i}]`,"Mute")}}),AppGain:{set:r=>o(e,`Strip[${t}]`,"AppGain",r),get:()=>r(e,`Strip[${t}]`,"AppGain")},AppMute:{set:r=>o(e,`Strip[${t}]`,"AppMute",r),get:()=>r(e,`Strip[${t}]`,"AppMute")},device:{name:{set:r=>o(e,`Strip[${t}]`,"device","name",r),get:()=>r(e,`Strip[${t}]`,"device","name")},sr:{set:r=>o(e,`Strip[${t}]`,"device","sr",r),get:()=>r(e,`Strip[${t}]`,"device","sr")},wdm:{set:r=>o(e,`Strip[${t}]`,"device","wdm",r),get:()=>r(e,`Strip[${t}]`,"device","wdm")},ks:{set:r=>o(e,`Strip[${t}]`,"device","ks",r),get:()=>r(e,`Strip[${t}]`,"device","ks")},mme:{set:r=>o(e,`Strip[${t}]`,"device","mme",r),get:()=>r(e,`Strip[${t}]`,"device","mme")},asio:{set:r=>o(e,`Strip[${t}]`,"device","asio",r),get:()=>r(e,`Strip[${t}]`,"device","asio")}}}),Bus:t=>({Mono:{set:r=>o(e,`Bus[${t}]`,"Mono",r),get:()=>r(e,`Bus[${t}]`,"Mono")},Mute:{set:r=>o(e,`Bus[${t}]`,"Mute",r),get:()=>r(e,`Bus[${t}]`,"Mute")},EQ:{on:{set:r=>o(e,`Bus[${t}]`,"EQ","on",r),get:()=>r(e,`Bus[${t}]`,"EQ","on")},AB:{set:r=>o(e,`Bus[${t}]`,"EQ","AB",r),get:()=>r(e,`Bus[${t}]`,"EQ","AB")},channel:i=>({cell:s=>({on:{set:r=>o(e,`Bus[${t}]`,"EQ",`channel[${i}]`,`cell[${s}]`,"on",r),get:()=>r(e,`Bus[${t}]`,"EQ",`channel[${i}]`,`cell[${s}]`,"on")},type:{set:r=>o(e,`Bus[${t}]`,"EQ",`channel[${i}]`,`cell[${s}]`,"type",r),get:()=>r(e,`Bus[${t}]`,"EQ",`channel[${i}]`,`cell[${s}]`,"type")},f:{set:r=>o(e,`Bus[${t}]`,"EQ",`channel[${i}]`,`cell[${s}]`,"f",r),get:()=>r(e,`Bus[${t}]`,"EQ",`channel[${i}]`,`cell[${s}]`,"f")},gain:{set:r=>o(e,`Bus[${t}]`,"EQ",`channel[${i}]`,`cell[${s}]`,"gain",r),get:()=>r(e,`Bus[${t}]`,"EQ",`channel[${i}]`,`cell[${s}]`,"gain")},q:{set:r=>o(e,`Bus[${t}]`,"EQ",`channel[${i}]`,`cell[${s}]`,"q",r),get:()=>r(e,`Bus[${t}]`,"EQ",`channel[${i}]`,`cell[${s}]`,"q")}})})},Gain:{set:r=>o(e,`Bus[${t}]`,"Gain",r),get:()=>r(e,`Bus[${t}]`,"Gain")},Label:{set:r=>o(e,`Bus[${t}]`,"Label",r),get:()=>r(e,`Bus[${t}]`,"Label")},mode:{normal:{set:r=>o(e,`Bus[${t}]`,"mode","normal",r),get:()=>r(e,`Bus[${t}]`,"mode","normal")},Amix:{set:r=>o(e,`Bus[${t}]`,"mode","Amix",r),get:()=>r(e,`Bus[${t}]`,"mode","Amix")},Bmix:{set:r=>o(e,`Bus[${t}]`,"mode","Bmix",r),get:()=>r(e,`Bus[${t}]`,"mode","Bmix")},Repeat:{set:r=>o(e,`Bus[${t}]`,"mode","Repeat",r),get:()=>r(e,`Bus[${t}]`,"mode","Repeat")},Composite:{set:r=>o(e,`Bus[${t}]`,"mode","Composite",r),get:()=>r(e,`Bus[${t}]`,"mode","Composite")},TVMix:{set:r=>o(e,`Bus[${t}]`,"mode","TVMix",r),get:()=>r(e,`Bus[${t}]`,"mode","TVMix")},UpMix21:{set:r=>o(e,`Bus[${t}]`,"mode","UpMix21",r),get:()=>r(e,`Bus[${t}]`,"mode","UpMix21")},UpMix41:{set:r=>o(e,`Bus[${t}]`,"mode","UpMix41",r),get:()=>r(e,`Bus[${t}]`,"mode","UpMix41")},UpMix61:{set:r=>o(e,`Bus[${t}]`,"mode","UpMix61",r),get:()=>r(e,`Bus[${t}]`,"mode","UpMix61")},CenterOnly:{set:r=>o(e,`Bus[${t}]`,"mode","CenterOnly",r),get:()=>r(e,`Bus[${t}]`,"mode","CenterOnly")},LFEOnly:{set:r=>o(e,`Bus[${t}]`,"mode","LFEOnly",r),get:()=>r(e,`Bus[${t}]`,"mode","LFEOnly")},RearOnly:{set:r=>o(e,`Bus[${t}]`,"mode","RearOnly",r),get:()=>r(e,`Bus[${t}]`,"mode","RearOnly")}},FadeTo:{set:r=>o(e,`Bus[${t}]`,"FadeTo",r),get:()=>r(e,`Bus[${t}]`,"FadeTo")},FadeBy:{set:r=>o(e,`Bus[${t}]`,"FadeBy",r),get:()=>r(e,`Bus[${t}]`,"FadeBy")},Sel:{set:r=>o(e,`Bus[${t}]`,"Sel",r),get:()=>r(e,`Bus[${t}]`,"Sel")},ReturnReverb:{set:r=>o(e,`Bus[${t}]`,"ReturnReverb",r),get:()=>r(e,`Bus[${t}]`,"ReturnReverb")},ReturnDelay:{set:r=>o(e,`Bus[${t}]`,"ReturnDelay",r),get:()=>r(e,`Bus[${t}]`,"ReturnDelay")},ReturnFx1:{set:r=>o(e,`Bus[${t}]`,"ReturnFx1",r),get:()=>r(e,`Bus[${t}]`,"ReturnFx1")},ReturnFx2:{set:r=>o(e,`Bus[${t}]`,"ReturnFx2",r),get:()=>r(e,`Bus[${t}]`,"ReturnFx2")},Monitor:{set:r=>o(e,`Bus[${t}]`,"Monitor",r),get:()=>r(e,`Bus[${t}]`,"Monitor")},VAIO:{set:r=>o(e,`Bus[${t}]`,"VAIO",r),get:()=>r(e,`Bus[${t}]`,"VAIO")},device:{name:{set:r=>o(e,`Bus[${t}]`,"device","name",r),get:()=>r(e,`Bus[${t}]`,"device","name")},sr:{set:r=>o(e,`Bus[${t}]`,"device","sr",r),get:()=>r(e,`Bus[${t}]`,"device","sr")},wdm:{set:r=>o(e,`Bus[${t}]`,"device","wdm",r),get:()=>r(e,`Bus[${t}]`,"device","wdm")},ks:{set:r=>o(e,`Bus[${t}]`,"device","ks",r),get:()=>r(e,`Bus[${t}]`,"device","ks")},mme:{set:r=>o(e,`Bus[${t}]`,"device","mme",r),get:()=>r(e,`Bus[${t}]`,"device","mme")},asio:{set:r=>o(e,`Bus[${t}]`,"device","asio",r),get:()=>r(e,`Bus[${t}]`,"device","asio")}}}),Fx:{Reverb:{On:{set:t=>o(e,"Fx","Reverb","On",t),get:()=>r(e,"Fx","Reverb","On")},AB:{set:t=>o(e,"Fx","Reverb","AB",t),get:()=>r(e,"Fx","Reverb","AB")}},Delay:{On:{set:t=>o(e,"Fx","Delay","On",t),get:()=>r(e,"Fx","Delay","On")},AB:{set:t=>o(e,"Fx","Delay","AB",t),get:()=>r(e,"Fx","Delay","AB")}}},patch:{asio:t=>({set:r=>o(e,"patch",`asio[${t}]`,r),get:()=>r(e,"patch",`asio[${t}]`)}),OutA2:t=>({set:r=>o(e,"patch",`OutA2[${t}]`,r),get:()=>r(e,"patch",`OutA2[${t}]`)}),OutA3:t=>({set:r=>o(e,"patch",`OutA3[${t}]`,r),get:()=>r(e,"patch",`OutA3[${t}]`)}),OutA4:t=>({set:r=>o(e,"patch",`OutA4[${t}]`,r),get:()=>r(e,"patch",`OutA4[${t}]`)}),OutA5:t=>({set:r=>o(e,"patch",`OutA5[${t}]`,r),get:()=>r(e,"patch",`OutA5[${t}]`)}),composite:t=>({set:r=>o(e,"Patch",`composite[${t}]`,r),get:()=>r(e,"Patch",`composite[${t}]`)}),insert:t=>({set:r=>o(e,"Patch",`insert[${t}]`,r),get:()=>r(e,"Patch",`insert[${t}]`)}),PostFaderComposite:{set:t=>o(e,"Patch","PostFaderComposite",t),get:()=>r(e,"Patch","PostFaderComposite")},PostFxInsert:{set:t=>o(e,"Patch","PostFxInsert",t),get:()=>r(e,"Patch","PostFxInsert")}},Option:{sr:{set:t=>o(e,"Option","sr",t),get:()=>r(e,"Option","sr")},ASIOsr:{set:t=>o(e,"Option","ASIOsr",t),get:()=>r(e,"Option","ASIOsr")},delay:t=>({set:r=>o(e,"Option",`delay[${t}]`,r),get:()=>r(e,"Option",`delay[${t}]`)}),buffer:{mme:{set:t=>o(e,"Option","buffer","mme",t),get:()=>r(e,"Option","buffer","mme")},wdm:{set:t=>o(e,"Option","buffer","wdm",t),get:()=>r(e,"Option","buffer","wdm")},ks:{set:t=>o(e,"Option","buffer","ks",t),get:()=>r(e,"Option","buffer","ks")},asio:{set:t=>o(e,"Option","buffer","asio",t),get:()=>r(e,"Option","buffer","asio")}},mode:{exclusif:{set:t=>o(e,"Option","mode","exclusif",t),get:()=>r(e,"Option","mode","exclusif")},swift:{set:t=>o(e,"Option","mode","swift",t),get:()=>r(e,"Option","mode","swift")}},MonitorOnSEL:{set:t=>o(e,"Option","MonitorOnSEL",t),get:()=>r(e,"Option","MonitorOnSEL")},SliderMode:{set:t=>o(e,"Option","SliderMode",t),get:()=>r(e,"Option","SliderMode")}},recorder:{stop:{set:t=>o(e,"recorder","stop",t),get:()=>r(e,"recorder","stop")},play:{set:t=>o(e,"recorder","play",t),get:()=>r(e,"recorder","play")},replay:{set:t=>o(e,"recorder","replay",t),get:()=>r(e,"recorder","replay")},ff:{set:t=>o(e,"recorder","ff",t),get:()=>r(e,"recorder","ff")},rew:{set:t=>o(e,"recorder","rew",t),get:()=>r(e,"recorder","rew")},A1:{set:t=>o(e,"recorder","A1",t),get:()=>r(e,"recorder","A1")},A2:{set:t=>o(e,"recorder","A2",t),get:()=>r(e,"recorder","A2")},A3:{set:t=>o(e,"recorder","A3",t),get:()=>r(e,"recorder","A3")},A4:{set:t=>o(e,"recorder","A4",t),get:()=>r(e,"recorder","A4")},A5:{set:t=>o(e,"recorder","A5",t),get:()=>r(e,"recorder","A5")},B1:{set:t=>o(e,"recorder","B1",t),get:()=>r(e,"recorder","B1")},B2:{set:t=>o(e,"recorder","B2",t),get:()=>r(e,"recorder","B2")},B3:{set:t=>o(e,"recorder","B3",t),get:()=>r(e,"recorder","B3")},record:{set:t=>o(e,"recorder","record",t),get:()=>r(e,"recorder","record")},pause:{set:t=>o(e,"recorder","pause",t),get:()=>r(e,"recorder","pause")},goto:{set:t=>o(e,"Recorder","goto",t),get:()=>r(e,"Recorder","goto")},load:{set:t=>o(e,"Recorder","load",t),get:()=>r(e,"Recorder","load")},samplerate:{set:t=>o(e,"Recorder","samplerate",t),get:()=>r(e,"Recorder","samplerate")},ArmStrip:t=>({set:r=>o(e,"Recorder",`ArmStrip(${t})`,r),get:()=>r(e,"Recorder",`ArmStrip(${t})`)}),ArmBus:t=>({set:r=>o(e,"Recorder",`ArmBus(${t})`,r),get:()=>r(e,"Recorder",`ArmBus(${t})`)}),mode:{recbus:{set:t=>o(e,"Recorder","mode","recbus",t),get:()=>r(e,"Recorder","mode","recbus")},PlayOnLoad:{set:t=>o(e,"Recorder","mode","PlayOnLoad",t),get:()=>r(e,"Recorder","mode","PlayOnLoad")},Loop:{set:t=>o(e,"Recorder","mode","Loop",t),get:()=>r(e,"Recorder","mode","Loop")},MultiTrack:{set:t=>o(e,"Recorder","mode","MultiTrack",t),get:()=>r(e,"Recorder","mode","MultiTrack")}},bitResolution:{set:t=>o(e,"Recorder","bitResolution",t),get:()=>r(e,"Recorder","bitResolution")},Channel:{set:t=>o(e,"Recorder","Channel",t),get:()=>r(e,"Recorder","Channel")},kbps:{set:t=>o(e,"Recorder","kbps",t),get:()=>r(e,"Recorder","kbps")},FileType:{set:t=>o(e,"Recorder","FileType",t),get:()=>r(e,"Recorder","FileType")},gain:{set:t=>o(e,"Recorder","gain",t),get:()=>r(e,"Recorder","gain")}},vban:{Enable:{set:t=>o(e,"vban","Enable",t),get:()=>r(e,"vban","Enable")},instream:t=>({on:{set:r=>o(e,"vban",`instream[${t}]`,"on",r),get:()=>r(e,"vban",`instream[${t}]`,"on")},name:{set:r=>o(e,"vban",`instream[${t}]`,"name",r),get:()=>r(e,"vban",`instream[${t}]`,"name")},ip:{set:r=>o(e,"vban",`instream[${t}]`,"ip",r),get:()=>r(e,"vban",`instream[${t}]`,"ip")},port:{set:r=>o(e,"vban",`instream[${t}]`,"port",r),get:()=>r(e,"vban",`instream[${t}]`,"port")},sr:{set:r=>o(e,"vban",`instream[${t}]`,"sr",r),get:()=>r(e,"vban",`instream[${t}]`,"sr")},channel:{set:r=>o(e,"vban",`instream[${t}]`,"channel",r),get:()=>r(e,"vban",`instream[${t}]`,"channel")},bit:{set:r=>o(e,"vban",`instream[${t}]`,"bit",r),get:()=>r(e,"vban",`instream[${t}]`,"bit")},quality:{set:r=>o(e,"vban",`instream[${t}]`,"quality",r),get:()=>r(e,"vban",`instream[${t}]`,"quality")},route:{set:r=>o(e,"vban",`instream[${t}]`,"route",r),get:()=>r(e,"vban",`instream[${t}]`,"route")}}),outstream:t=>({on:{set:r=>o(e,"vban",`outstream[${t}]`,"on",r),get:()=>r(e,"vban",`outstream[${t}]`,"on")},name:{set:r=>o(e,"vban",`outstream[${t}]`,"name",r),get:()=>r(e,"vban",`outstream[${t}]`,"name")},ip:{set:r=>o(e,"vban",`outstream[${t}]`,"ip",r),get:()=>r(e,"vban",`outstream[${t}]`,"ip")},port:{set:r=>o(e,"vban",`outstream[${t}]`,"port",r),get:()=>r(e,"vban",`outstream[${t}]`,"port")},sr:{set:r=>o(e,"vban",`outstream[${t}]`,"sr",r),get:()=>r(e,"vban",`outstream[${t}]`,"sr")},channel:{set:r=>o(e,"vban",`outstream[${t}]`,"channel",r),get:()=>r(e,"vban",`outstream[${t}]`,"channel")},bit:{set:r=>o(e,"vban",`outstream[${t}]`,"bit",r),get:()=>r(e,"vban",`outstream[${t}]`,"bit")},quality:{set:r=>o(e,"vban",`outstream[${t}]`,"quality",r),get:()=>r(e,"vban",`outstream[${t}]`,"quality")},route:{set:r=>o(e,"vban",`outstream[${t}]`,"route",r),get:()=>r(e,"vban",`outstream[${t}]`,"route")}})}}),this.attachChangeEvent=e=>{this.eventPool.push(e)},this.getOption=e=>{if(!this.isConnected)throw new Error("Not correct connected ");if(this.stringParameters.some(t=>e.includes(t))){const t=Buffer.alloc(512);return i.VBVMR_GetParameterStringA(e,t),String.fromCharCode.apply(null,t).split("").filter(e=>"\0"!==e).join("")}const t=[0];return i.VBVMR_GetParameterFloat(e,t),t[0]},this.setOption=e=>{const t=Buffer.alloc(e.length+1);return t.fill(0).write(e),i.VBVMR_SetParameters(t),new Promise(e=>setTimeout(e,200))},this.checkPropertyChange=()=>{1===this.isParametersDirty()&&this.eventPool.forEach(e=>{e()})},this.getVoicemeeterType=()=>{const e=[0];if(0!==i.VBVMR_GetVoicemeeterType(e))throw new Error("running failed");switch(e[0]){case 1:return"voicemeeter";case 2:return"voicemeeterBanana";case 3:return"voicemeeterPotato";default:throw new Error("Voicemeeter seems not to be installed")}},this.getVoicemeeterVersion=()=>{const e=[0];if(0!==i.VBVMR_GetVoicemeeterVersion(e))throw new Error("running failed");return((4278190080&e[0])>>24)+"."+((16711680&e[0])>>16)+"."+((65280&e[0])>>8)+"."+(255&e[0])},this.getLevel=(e,t)=>{const r=[0];return i.VBVMR_GetLevel(e,t,r),r[0]}}static async init(){const r=await(async()=>{const e=new t({hive:t.HKLM,key:"\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\VB:Voicemeeter {17359A74-1236-5467}"});return new Promise(t=>{e.values((e,r)=>{if(e)throw new Error(e);const o=r.find(e=>"UninstallString"===e.name).value,i=o.lastIndexOf("\\");t(o.slice(0,i))})})})();return new Promise(t=>{s||(s=new n);const o=e.load(`${r}/VoicemeeterRemote64.dll`);i={VBVMR_Login:o.func("long __stdcall VBVMR_Login(void)"),VBVMR_Logout:o.func("long __stdcall VBVMR_Logout(void)"),VBVMR_RunVoicemeeter:o.func("long __stdcall VBVMR_RunVoicemeeter(long mode)"),VBVMR_IsParametersDirty:o.func("long __stdcall VBVMR_IsParametersDirty(void)"),VBVMR_GetLevel:o.func("long __stdcall VBVMR_GetLevel(long type, long channel, _Out_ float* value)"),VBVMR_GetParameterFloat:o.func("long __stdcall VBVMR_GetParameterFloat(const char* param, _Out_ float* value)"),VBVMR_GetParameterStringA:o.func("long __stdcall VBVMR_GetParameterStringA(const char* param, _Out_ char* value)"),VBVMR_SetParameters:o.func("long __stdcall VBVMR_SetParameters(const char* param)"),VBVMR_Output_GetDeviceNumber:o.func("long __stdcall VBVMR_Output_GetDeviceNumber(void)"),VBVMR_Output_GetDeviceDescA:o.func("long __stdcall VBVMR_Output_GetDeviceDescA(long index, _Out_ long* type, _Out_ char* name, _Out_ char* hardwareId)"),VBVMR_Input_GetDeviceNumber:o.func("long __stdcall VBVMR_Input_GetDeviceNumber(void)"),VBVMR_Input_GetDeviceDescA:o.func("long __stdcall VBVMR_Input_GetDeviceDescA(long index, long* type, char* name, char* hardwareId)"),VBVMR_GetVoicemeeterType:o.func("long __stdcall VBVMR_GetVoicemeeterType(_Out_ long* type)"),VBVMR_GetVoicemeeterVersion:o.func("long __stdcall VBVMR_GetVoicemeeterVersion(_Out_ long* version)")},s.isInitialised=!0,t(s)})}get $outputDevices(){return this.outputDevices}get $inputDevices(){return this.inputDevices}get $version(){return this.version}get $type(){return this.type}}var a={__proto__:null};export{n as Voicemeeter,a as types};
//# sourceMappingURL=index.modern.js.map
